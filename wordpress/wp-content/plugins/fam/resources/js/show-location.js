function RenderMaps(e) { e = typeof e !== "undefined" ? $(e) : $("body"); RenderMapElements(e) } function RenderMapElements(e) { $(e).find(".content-location").each(function (e, t) { var n = jQuery(this).find(".locationImage").val(); var r = '<img src="' + n + '" />'; var i = $("body").find('div[id^="locationMap_"]').length; var s = "locationMap_" + e + i; var o = jQuery(this).parent().height(); jQuery(this).height(o); var u = jQuery(this).parent().width(); var a = jQuery(this).find(".latitude").val(); var f = jQuery(this).find(".longitude").val(); var l = jQuery(this).find(".local").val(); var c = jQuery(this).find(".enable_controls").val(); if (a != null && f != null) { if ($(this).find(".image_map").length > 0 && $(this).find(".image_map").val() == "yes") { SetImageMap(u, o, 14, a, f, this, l) } else { jQuery(this).append('<div style="width:' + u + "px;height:" + o + 'px" id="' + s + '"></div>'); ShowLocation(a, f, r, l, s, c) } } else { jQuery(this).hide() } }) } function ShowLocation(e, t, n, r, i, s) { if (e != null && t != null && t != "" && e != "") { var o = true; if (s != null && s == "false") { o = false } var u = { center: new google.maps.LatLng(e, t), zoom: 13, mapTypeId: google.maps.MapTypeId.ROADMAP, streetViewControl: o, mapTypeControl: o, scrollwheel: false }; var a = document.getElementById(i); var f = new google.maps.Map(a, u); f.setOptions({ zoomControl: o }); var l = new google.maps.Marker({ position: new google.maps.LatLng(e, t), map: f, title: "contentLocal", icon: "/wp-content/themes/images/icoFam.png" }); var c = jQuery(a).height(); if (c > 300) { var h = new google.maps.InfoWindow; var p = ""; if (n != null) { p = n + "<br><div><strong>" + r + "</strong><br>" } else { p = "<div><strong>" + r + "</strong><br>" } h.setContent(p); h.open(f, l) } } else { jQuery("#locationInfo_relato").hide(); jQuery(i).parents(".locationInfo").hide() } } function SetImageMap(e, t, n, r, i, s, o) { var u = null; $.ajax({ url: "/FAMCore/Async/action.php", type: "post", dataType: "html", async: false, data: { action: "get_image_map_src", map_service_width: e, map_service_height: t, map_service_zoom: n, map_service_lat: r, map_service_long: i }, success: function (e) { if (e == "error") { u = false } else { var t = '<img border="0" src="' + e + '" alt="' + o + '">'; $(s).append(t) } }, error: function (e, t) { u = false } }) } jQuery(document).ready(function () { RenderMaps() })