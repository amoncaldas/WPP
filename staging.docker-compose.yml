version: '3.1'

networks:
  fam:
    driver: bridge

services:
    wordpress:
        container_name: fam-website-staging
        image: custom-wordpress-staging
        networks:
          - fam
        restart: always
        build:
          context: wordpress/build
          args:
            DEBUG_SUPPORT: "false"
        ports:
          - 8081:80        
        environment:
          WORDPRESS_DB_PASSWORD: admin
          SITE_URL: http://staging.fazendoasmalas.com
          ENABLE_DEBUG: "false" # enable/disable debug mode in wordpress at run time     
        volumes:
          - ./wordpress/wp-content:/var/www/html/wp-content
          - ./webapp:/var/www/webapp
    mysql:
        container_name: fam-mysql-staging
        image: custom-mysql-5.7-staging
        networks:
          - fam
        restart: always
        build:
          context: mysql/
          args:
            IMPORT_DB: "true" # Remember: the import will only work if the wordpress/db dir is empty
            MYSQL_ROOT_PASS: admin # Used during the build and internally is defined as ENV MYSQL_ROOT_PASSWORD
        volumes:
          - ./wordpress/db:/var/lib/mysql
